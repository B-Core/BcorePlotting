<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Wrapper for qcQvalue function to verify q-value analysis...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for qcQ_wrapper"><tr><td>qcQ_wrapper</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Wrapper for qcQvalue function to verify q-value analysis terms</h2>

<h3>Description</h3>

<p>Creates plots for each design factor (default behavior), or for factors facSel
1) Histogram of p-values that were included in the design
2) qvalue's default plots with full q-value range (c(0,1)).
3) Optional MDS plot at q-value cut
</p>


<h3>Usage</h3>

<pre>
qcQ_wrapper(norm_x, p_mat, q_list, metadata, plotdata, plot2file = TRUE,
  bonusMDS = FALSE, oneclass = NULL, qcut = 0.1, histbins = 40,
  colorspec = c("#7b3294", "#008837"), facSel = NULL, filesep = "/")
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>norm_x</code></td>
<td>
<p>abundance data input into regression (eg, regressMatrix()). nrow(norm_x)==length(p_mat)</p>
</td></tr>
<tr valign="top"><td><code>p_mat</code></td>
<td>
<p>matrix of p-values for each factor. Returned by regressMatrix()</p>
</td></tr>
<tr valign="top"><td><code>q_list</code></td>
<td>
<p>S3 object; list of p-value lists for each factor. Returned by regressMatrix()</p>
</td></tr>
<tr valign="top"><td><code>metadata</code></td>
<td>
<p>list of factors; each list element is a factor (eg, sex = c(&quot;m&quot;, &quot;f&quot;...)) #Feedback perhaps as.factor(c(&quot;m&quot;,&quot;f&quot;))?
Vector order same as norm_x column order
was attribs previously</p>
</td></tr>
<tr valign="top"><td><code>plotdata</code></td>
<td>
<p>is a list of info relevant to labeling and saving the plot With the following elements:
plotdir:  plot destination directory
plotbase:  base filename for the plot. Suggest: bias reduction method
plottitle:  title for all plots
plotSubtitle:  optional subtitle; suggest lm_expression</p>
</td></tr>
<tr valign="top"><td><code>plot2file</code></td>
<td>
<p>logical. if TRUE, write files using plotdata, otherwise to studio graphics viewer</p>
</td></tr>
<tr valign="top"><td><code>bonusMDS</code></td>
<td>
<p>logical. if TRUE plots an MDS of data at qcut (see below). Default is FALSE (no plot)</p>
</td></tr>
<tr valign="top"><td><code>oneclass</code></td>
<td>
<p>metadata vector for labeling bonusMDS data; if NULL or not specified, defaults to the first element of metadata</p>
</td></tr>
<tr valign="top"><td><code>qcut</code></td>
<td>
<p>either a number between 0 and 1 used as an upper qvalue limit for MDS, OR a number &gt;1, assumed to be the top n qvalues to use in MDS</p>
</td></tr>
<tr valign="top"><td><code>histbins</code></td>
<td>
<p>number of bins for p-value histogram; may want to change if there is suspicious behavior</p>
</td></tr>
<tr valign="top"><td><code>colorspec</code></td>
<td>
<p>optional range of colors for MDS plot. Defaults to hotpink/green!</p>
</td></tr>
<tr valign="top"><td><code>facSel</code></td>
<td>
<p>optional vector of experimental factors to plot (rather than all factors) #Feedback to plot for the MDS plot? What if you want to plot based on second element of metadata list?</p>
</td></tr>
<tr valign="top"><td><code>filesep</code></td>
<td>
<p>string that adds to end of directory path.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Writes plots to files or to Rstudio viewer. Notes - Looking for even descent to pi0 in top left tuning plot. The slow/steep rise in q-values
in remaining plots depends on the resolving power of the data.
</p>


</body></html>
